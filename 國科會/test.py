import numpy as np

# 你的數據 (注意順序：力 F 在前，位移 x 在後)
F = np.array([
    25.05302, 25.10707, 25.16905, 25.22787, 25.28191, 25.33277, 25.38522,
    25.43608, 25.49489, 25.55688, 25.61569, 25.67132, 25.72536, 25.77305,
    25.82391, 25.88272, 25.94153, 25.99557, 26.04961, 26.12114, 26.19902,
    26.2626, 26.31187, 26.36115, 26.41996, 26.48672, 26.54711, 26.59957
])
x = np.array([
    0, 1E-04, 0.0002, 0.0003, 0.0004, 0.0005, 0.0006, 0.0007, 0.0008, 0.0009,
    0.0010001, 0.0011, 0.0012, 0.0013, 0.0014, 0.0015, 0.0016, 0.0017, 0.0018,
    0.0019001, 0.002, 0.0021, 0.0022, 0.0023, 0.0024, 0.0025, 0.0026, 0.0027
])

# 使用 NumPy 的梯形法
U_numpy = np.trapz(F, x)
print(f"NumPy 計算應變能: {U_numpy:.10f}")

# 使用手動梯形法計算 (與 Excel 公式相同)
U_manual = sum((F[i] + F[i+1]) / 2 * (x[i+1] - x[i]) for i in range(len(x)-1))
print(f"手動計算應變能: {U_manual:.10f}")
